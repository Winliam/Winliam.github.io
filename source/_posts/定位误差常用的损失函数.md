---
title: 定位误差常用的损失函数
categories:
  - - 工作技能
    - 神经网络
date: 2020-11-12 17:36:56
math: true
tags:
  - 损失函数
  - IOU
  - GIOU
  - DIOU
  - CIOU
---
## 前言
在目标检测任务中，为了更好的量化定位损失，各路大神想了很多办法。从最开始的针对xywh的均方误差，到IOU损失，再到后续的GIOU损失、DIOU损失、CIOU损失，越来越复杂。其中均方误差比较简单，不再介绍。重点讲一下IOU系列。

<div align=center><img title="" src="/img/article/iou.png" width="80%" height="80%" align=center></div>

## IOU损失
这里牵涉到两个概念，“IOU”和“IOU损失”，对于前者，已经很熟悉了，不再赘述。而对于后者，则是简单地令
$$
IOU loss = - \ln(\frac{I}{U})
$$
这样，IOU越接近于1，损失越接近于0。并且相比于均方误差没有尺度大小影响wh损失的现象。但美中不足的是，当I=0，即两个框不相交时无法正确计算。

## GeneralizedIOU损失
$$
GIOU = \frac{I}{U} - \frac{D_1 + D_2}{S}
$$
$$
GIOU loss = 1 - GIOU
$$
IOU越大，损失越小。D1和D2占S的比例越大，IOU越大。

## DistanceIOU损失
$$
DIOU = \frac{I}{U} - \frac{d^2}{c^2}
$$
$$
DIOU loss = 1 - DIOU
$$
IOU越大，损失越小。d越小，两个框的中心越接近，损失越小。

## CompleteIOU损失
作者说，一个好的定位误差量化指标应该兼顾：**重叠面积**、**中心点距离**、**长宽比**。前两者在DIOU中都已经考虑了，因此CIOU又增加了长宽比这一因素，也就是说两个框的形状哪怕不全等，也应该尽可能相似。
$$
CIOU = \frac{I}{U} - \frac{d^2}{c^2} - \alpha v
$$
$$
v = \frac{4}{\pi ^2}({\rm arctan} \frac{w_1}{h_1} - {\rm arctan} \frac{w_2}{h_2})^2
$$
$$
\alpha = \frac{v}{(1-IOU)+v}
$$
$$
CIOU loss = 1 - CIOU
$$
$\alpha v$暂时看不懂是啥原理，暂时知道是在比较两个框的相似程度就够了，而且越小越相似。



